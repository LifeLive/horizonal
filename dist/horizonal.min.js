/*! horizonal 14-07-2014 */
!function(a,b){function c(){var b={selector:"h1, h2, h3, h4, h5, h6, p, li, img, table",stagger:"random",staggerDelay:.1,transitionSpeed:1,customCssFile:!1,displayScrollbar:!0,scrollStep:2,pageMargin:20};this.init=function(c){p=a.extend({},b,c),r=a("body").clone(),f(),d(),e(),o.showPage(1)}}function d(){a("body").wrapInner('<div id="hrz-container"></div>'),q=a("#hrz-container"),s=a(b).height()-2*p.pageMargin;var c=new l(p.selector);o=c.splitIntoPages(),o.renderToDom(),q.children().not(".hrz-page").filter(":visible").remove();var d=o.last().bottom/p.scrollStep+s;a("body").height(d),p.displayScrollbar||a("body").css("overflow-y","hidden")}function e(){a(b).on("resize",h(g,250)),a(b).on("keydown",i),a(b).on("scroll",j)}function f(){var b;p.customCssFile&&(b=a("#hrz-custom-css"),0<b.length?b.attr("href",p.customCssFile):a("head").append('<link rel="stylesheet" id="hrz-custom-css" href="'+p.customCssFile+'" type="text/css" />'))}function g(){var c=o.getCurrent().nodes[0].layout.top/p.scrollStep;a("body").replaceWith(r.clone()),d(),a(b).scrollTop(c)}function h(a,b){var c;return function(){clearTimeout(c),c=setTimeout(function(){a()},b)}}function i(c){var d;40===c.which||39===c.which?d=o.getCurrent().bottom/p.scrollStep+10:(38===c.which||37===c.which)&&(d=o.getPrevious().top/p.scrollStep+2*p.pageMargin+10),void 0!==d&&a(b).scrollTop(d)}function j(){var c=a(b).scrollTop(),d=o.currentPage,e=o.getPageAtOffset(c*p.scrollStep).pageNumber;e!==d&&o.showPage(e)}function k(b,c){this.domNode=b,this.index=c,this.isClone=!1,this.layout=this.getLayout(),this.isTall=!1,this.pageOverhang=0,a(this.domNode).addClass("hrz-element hrz-fore")}function l(a){"undefined"!=typeof a&&this.fromSelector(a)}function m(a){this.top=0,this.bottom=0,this.height=0,this.nodes=new l,this.pageNumber=a||0,this.domNode=null,Object.defineProperty(this,"pageId",{get:function(){return"hrz-page-"+this.pageNumber}})}function n(){var a=0;Object.defineProperty(this,"currentPage",{get:function(){return a},set:function(b){a=this.last()<b?this.last():1>b?1:b}})}var o,p,q,r,s;k.prototype={getLayout:function(){var b=a(this.domNode),c=b.offset().left,d=b.offset().top-parseInt(b.css("margin-top")),e=b.width(),f=b.height(),g=d+f;return{top:d,left:c,bottom:g,width:e,height:f}},makeClone:function(b){var c=a(this.domNode).clone()[0],d=new k(c,b);return d.layout={top:this.layout.top,left:this.layout.left,width:this.layout.width,height:this.layout.height,bottom:this.layout.bottom},d.isClone=!0,d},renderToDom:function(b){a(this.domNode).addClass(b.pageId),a("#"+b.pageId).append(this.domNode),this.setCssProperties(b.top)},setCssProperties:function(b){var c=this.getStaggerDelay(),d=1===this.page?0:p.pageMargin;a(this.domNode).css({position:"fixed",top:this.layout.top-b+d+"px",left:this.layout.left+"px",width:this.layout.width+"px",height:this.layout.height+"px",transition:"transform "+c+"s, opacity "+c+"s","-webkit-transition":"-webkit-transform "+c+"s, opacity "+c+"s"})},getStaggerDelay:function(){var a;return a="random"===p.stagger?.5*Math.random()+.7:"sequence"===p.stagger?Math.log(this.pageOrder+2):1,a/p.transitionSpeed},moveToForeground:function(){a(this.domNode).addClass("hrz-fore")},moveToBackground:function(){a(this.domNode).addClass("hrz-back")},moveToFocus:function(){a(this.domNode).removeClass("hrz-fore hrz-back")}};var t={fromSelector:function(b){var c=this,d=a(b).filter(":visible");d.each(function(a,b){c.push(new k(b,a))})},splitIntoPages:function(){var a,b=1,c=new n;for(a=0;a<this.length;a++){var d=this[a],e=c.getLastOffset()+s,f=s/2<d.layout.height&&e<d.layout.bottom;if(f&&!d.isClone){d.isTall=!0;for(var g=d.layout.bottom-e,h=1;g>0;){var i=a+h,j=d.makeClone(i);j.pageOverhang=g,this.splice(i,0,j),g-=s,h++}}b=this.calculateLastPageAndPageOffset(d,c,b),c.getPage(b).addNode(d)}return c},calculateLastPageAndPageOffset:function(a,b,c){if(void 0!==b[c-1]){var d=b.getPage(c),e=d.top+s;if(d.bottom<=a.layout.bottom){var f=e<a.layout.bottom;if(a.isTall)f&&(d.bottom=e);else if(f||a.isClone){c++,b.add();var g=b.last();s<a.layout.height?(g.bottom=e,a.pageOverhang&&(g.bottom+=Math.min(a.pageOverhang,s))):g.bottom=a.layout.bottom}else d.bottom=a.layout.bottom}}else b.add(),b.last().bottom=a.layout.bottom;return c},renderToDom:function(a){this.forEach(function(b){b.renderToDom(a)})}};l.prototype=[],a.extend(l.prototype,t),m.prototype={addNode:function(a){this.nodes.push(a)},renderToDom:function(){q.prepend('<div class="hrz-page hrz-fore" id="'+this.pageId+'" />'),this.domNode=a("#"+this.pageId)[0],this.nodes.renderToDom(this)},moveToForeground:function(){a(this.domNode).addClass("hrz-fore"),this.nodes.forEach(function(a){a.moveToForeground()})},moveToBackground:function(){a(this.domNode).addClass("hrz-back"),this.nodes.forEach(function(a){a.moveToBackground()})},moveToFocus:function(){a(this.domNode).removeClass("hrz-fore hrz-back"),this.nodes.forEach(function(a){a.moveToFocus()})}};var u={getPage:function(a){return a>0&&a<=this.length?this[a-1]:new m},getCurrent:function(){return this.getPage(this.currentPage)},getPrevious:function(){return this.getPage(this.currentPage-1)},add:function(){var a=this.length+1,b=new m(a);b.top=this.getPage(this.length).bottom,this.push(b)},last:function(){return this[this.length-1]},getLastOffset:function(){return this.length<=1?0:this.last().top},getPageAtOffset:function(a){return this.filter(function(b){return b.top<=a&&a<b.bottom})[0]},renderToDom:function(){this.forEach(function(a){a.renderToDom()})},showPage:function(a){var b=this.currentPage;this.currentPage=a;var c=this.currentPage;0===b?this.getPage(c).moveToFocus():c>b?(this.getPage(b).moveToBackground(),this.getPage(c).moveToFocus()):b>c&&(this.getPage(b).moveToForeground(),this.getPage(c).moveToFocus())}};n.prototype=[],a.extend(n.prototype,u),b.horizonal=function(){var a=new c;return{init:a.init}}()}(jQuery,window,document);