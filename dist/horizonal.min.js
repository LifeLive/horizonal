/*! horizonal 13-07-2014 */
!function(a,b){function c(){var c={selector:"h1, h2, h3, h4, h5, h6, p, li, img, table",stagger:"random",staggerDelay:.1,transitionSpeed:1,customCssFile:!1,displayScrollbar:!0,pageMargin:20};this.init=function(g){o=[0],m=1,q=a.extend({},c,g),p=new l(q.selector),n=a("body").clone(),a("body").wrapInner('<div id="hrz-container"></div>'),r=a("#hrz-container");var h={viewportHeight:a(b).height()-2*q.pageMargin};p.calculateNodePositionsAndPages(h),f(),e(m),d(),r.children().not(".hrz-page").filter(":visible").remove()}}function d(){a(b).on("resize",h(g,250)),a(b).on("keydown",i),a(b).on("scroll",j)}function e(b){for(var c=o.length-1,d=1;c>=d;d++)b>d?a("#hrz-page-"+d).addClass("hrz-back"):d>b?a("#hrz-page-"+d).addClass("hrz-fore"):a("#hrz-page-"+d).removeClass("hrz-fore hrz-back");a.each(p,function(a,c){c.page<b?c.moveToBackground():b<c.page?c.moveToForground():c.moveToFocus()})}function f(){var b;q.customCssFile&&(b=a("#hrz-custom-css"),0<b.length?b.attr("href",q.customCssFile):a("head").append('<link rel="stylesheet" id="hrz-custom-css" href="'+q.customCssFile+'" type="text/css" />'))}function g(){a("body").replaceWith(n.clone()),p=new l(q.selector);var c={viewportHeight:a(b).height()-2*q.pageMargin};p.calculateNodePositionsAndPages(c),e(m)}function h(a,b){var c;return function(){clearTimeout(c),c=setTimeout(function(){a()},b)}}function i(c){var d,e=o.length-1;40===c.which||39===c.which?m!==e&&(d=o[m]+10):(38===c.which||37===c.which)&&(d=1===m?o[m-1]:o[m-2]),void 0!==d&&a(b).scrollTop(d)}function j(){var c=a(b).scrollTop(),d=0===m?0:o[m-1],f=o[m];d>c?(m--,e(m)):c>f&&(m++,e(m))}function k(b,c){this.domNode=b,this.index=c,this.page=null,this.isClone=!1,this.layout=this.getLayout(),this.isTall=!1,this.pageOverhang=0,a(this.domNode).addClass("hrz-element hrz-fore")}function l(a){"undefined"!=typeof a&&this.fromSelector(a)}var m,n,o,p,q,r;k.prototype={getLayout:function(){var b=a(this.domNode),c=b.offset().left,d=b.offset().top-parseInt(b.css("margin-top")),e=b.width(),f=b.height(),g=d+f;return{top:d,left:c,bottom:g,width:e,height:f}},makeClone:function(b){var c=a(this.domNode).clone()[0],d=new k(c,b);return d.layout={top:this.layout.top,left:this.layout.left,width:this.layout.width,height:this.layout.height,bottom:this.layout.bottom},d.isClone=!0,d},setPage:function(b){this.page=b,a(this.domNode).addClass("hrz-page-"+b),0===a("#hrz-page-"+this.page).length&&r.prepend('<div class="hrz-page" id="hrz-page-'+this.page+'" />'),a("#hrz-page-"+this.page).append(this.domNode)},setCssProperties:function(){var b=o[this.page-1],c=this.getStaggerDelay(),d=1===this.page?0:q.pageMargin;a(this.domNode).css({position:"fixed",top:this.layout.top-b+d+"px",left:this.layout.left+"px",width:this.layout.width+"px",height:this.layout.height+"px",transition:"transform "+c+"s, opacity "+c+"s","-webkit-transition":"-webkit-transform "+c+"s, opacity "+c+"s"})},getStaggerDelay:function(){var a;return a="random"===q.stagger?.5*Math.random()+.7:"sequence"===q.stagger?Math.log(this.pageOrder+2):1,a/q.transitionSpeed},moveToForground:function(){a(this.domNode).addClass("hrz-fore")},moveToBackground:function(){a(this.domNode).addClass("hrz-back")},moveToFocus:function(){a(this.domNode).removeClass("hrz-fore hrz-back")}};var s={fromSelector:function(b){var c=this,d=a(b).filter(":visible");d.each(function(a,b){c.push(new k(b,a))})},calculateNodePositionsAndPages:function(b){function c(a){if(void 0!==o[f]){if(o[f]<=a.layout.bottom){var b=i<a.layout.bottom;a.isTall?b&&(o[f]=i):b||a.isClone?(f++,e<a.layout.height?(o[f]=i,a.pageOverhang&&(o[f]+=Math.min(a.pageOverhang,e))):o[f]=a.layout.bottom):o[f]=a.layout.bottom}}else o[f]=a.layout.bottom}var d,e=b.viewportHeight,f=1;for(d=0;d<this.length;d++){var g=this[d],h=void 0===o[f-1]?0:o[f-1],i=h+e,j=e/2<g.layout.height&&i<g.layout.bottom;if(j&&!g.isClone){g.isTall=!0;for(var k=g.layout.bottom-i,l=1;k>0;){var m=d+l,n=g.makeClone(m);n.pageOverhang=k,p.splice(m,0,n),k-=e,l++}}c(g),g.setPage(f)}a.each(this,function(a,b){b.setCssProperties()});var r=o[o.length-1]+e;a("body").height(r),q.displayScrollbar||a("body").css("overflow-y","hidden")}};l.prototype=[],a.extend(l.prototype,s),b.horizonal=function(){var a=new c;return{init:a.init}}()}(jQuery,window,document);