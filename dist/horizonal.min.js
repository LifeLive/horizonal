/*! horizonal 29-08-2014 */
!function(a,b,c){function d(){function c(c){var d=a(b).scrollTop();I=a.extend({},A,c),x().then(function(){y?o():(K=a(I.rootElement),L=K.clone(),e(d).then(function(){l(),j(),""!==b.location.hash&&s(),y=!0}))})}function d(){z||(K.replaceWith(L.clone()),I.displayScrollbar||a("body").css("overflow-y",""),m(),k(),z=!0)}function f(){z&&(o(),j(),z=!1)}function g(a){var b;"#"===a.substr(0,1)?s(a):(b=a,H.showPage(b))}function h(){var c=H.currentPage,d=H.length;if(d>c){var e=H.getPage(c+1).midPoint;a(b).scrollTop(e)}}function i(){var c=H.currentPage;if(c>1){var d=H.getPage(c-1).midPoint;a(b).scrollTop(d)}}function j(){a(b).on("resize",o),a(b).on("keydown",p),a(b).on("scroll",q),a(b).on("hashchange",s),a(b).on("touchstart pointerdown MSPointerDown",u),a(b).on("touchend pointerup MSPointerUp",w),a(b).on("touchmove pointermove MSPointerMove",v),a("a").on("click",t),a(b.document).on("wheel",r)}function m(){a(b).off("resize",o),a(b).off("keydown",p),a(b).off("scroll",q),a(b).off("hashchange",s),a(b).off("touchstart pointerdown MSPointerDown",u),a(b).off("touchend pointerup MSPointerUp",w),a(b).off("touchmove pointermove MSPointerMove",v),a("a").off("click",t)}function x(){function b(a){N=a,c.resolve()}var c=new a.Deferred;return I.customCssFile?a.get(I.customCssFile).then(b):(a("#hrz-custom-css").remove(),c.resolve()),c.promise()}var y=!1,z=!1,A={selector:"h1, h2, h3, h4, h5, h6, p, li, img, table",staggerDelay:.1,stagger:"random",customCssFile:!1,displayScrollbar:!0,scrollbarShortenRatio:2,pageMargin:20,displayPageCount:!0,rootElement:"body",newPageClass:"hrz-start-new-page",pageHideDelay:1,onResize:n,onNodeTransition:n,onPageTransition:n};return{init:c,disable:d,enable:f,goTo:g,next:h,previous:i}}function e(c){var d=new a.Deferred;K=a(I.rootElement);var e=g();return J=a(e.querySelector("#hrz-container")),J.css({display:"none",top:0,left:0}),M=a(b).height()-2*I.pageMargin,h().then(function(){setTimeout(function(){var b=new E(I.selector);H=O.fromNodeCollection(b),H.appendToDom(c),J.children().not(".hrz-page").filter(":visible").remove(),K.empty().append(e),f(),H.forEach(function(a){a.nodes.forEach(function(b){b.renderStyles(a)})}),J.css("display","");var g=H.last().bottom/I.scrollbarShortenRatio+M;K.height(g),I.displayScrollbar||a("body").css("overflow-y","hidden"),j(),i(),d.resolve()},0)}),d.promise()}function f(){var b=a("#hrz-custom-css");0<b.length?b.text(N):a("head").append('<style id="hrz-custom-css" type="text/css">'+N+"</style>")}function g(){var a=c.createDocumentFragment(),b=c.createElement("div");return b.id="hrz-container",a.appendChild(b),a}function h(){var b=new a.Deferred;return 0===a(".hrz-loading-indicator").length&&(a("body").append('<div class="hrz-loading-indicator" style="display:none;"><p class="hrz-loading-indicator">Loading...</p></div>'),a("div.hrz-loading-indicator").fadeIn(50,function(){b.resolve()})),b.promise()}function i(){setTimeout(function(){a("div.hrz-loading-indicator").fadeOut(50,function(){a(this).remove()})},300)}function j(){if(0===a(".hrz-page-count").length){var b=a('<div class="hrz-page-count"></div>');a("body").append(b),b.append('<span id="hrz-current-page"></span> / <span id="hrz-total-pages"></span>'),a("#hrz-total-pages").html(H.length),I.displayPageCount||b.addClass("hidden")}}function k(){a(".hrz-page-count").remove()}function l(){a("#hrz-current-page").html(H.currentPage)}function m(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}function n(){}function o(){x(function(){var c=H.getCurrent().nodes[0].layout.top/I.scrollbarShortenRatio;K.replaceWith(L.clone()),e(c).then(function(){a(b).scrollTop(c),l(),I.onResize()})},250)()}function p(c){var d;40===c.which||39===c.which?H.currentPage<H.length&&(d=H.getNext().midPoint):(38===c.which||37===c.which)&&(2===H.currentPage?d=0:1<H.currentPage&&(d=H.getPrevious().midPoint)),void 0!==d&&(a(b).scrollTop(d),c.preventDefault())}function q(){if("undefined"!=typeof H){var c=a(b).scrollTop(),d=H.currentPage,e=H.getPageAtOffset(c*I.scrollbarShortenRatio).pageNumber;e!==d&&(H.showPage(e),l())}}function r(c){c.preventDefault();var d=(new Date).getTime();if(d-P>250||!P){P=(new Date).getTime(),console.log(c.originalEvent.deltaY);var e,f=c.originalEvent.deltaY;0>f?2===H.currentPage?e=0:1<H.currentPage&&(e=H.getPrevious().midPoint):f>0&&H.currentPage<H.length&&(e=H.getNext().midPoint),"undefined"!=typeof e&&(a(b).scrollTop(e),d-P>250&&(P=null))}}function s(){var c=b.location.hash;if(""!==c){var d=a(c).closest(".hrz-page"),e=parseInt(d.attr("id").replace(/^\D+/g,""));H.showPage(e),a(b).scrollTop(H.getCurrent().midPoint),l()}}function t(){var c=b.location.hash;if(""!==c){var d=a(this).attr("href");if("#"===d.substr(0,1)&&d===c)return s(),!1}}function u(a){y(a)&&(Q={x:B(a),y:C(a)},R=(new Date).getTime())}function v(a){if(y(a)){a.preventDefault();var b={x:B(a),y:C(a)},c=(new Date).getTime();if(z(R,c,Q,b)){var d=A(Q,b);switch(d){case"up":J.css("top","-30px");break;case"down":J.css("top","30px");break;case"left":J.css("left","-30px");break;case"right":J.css("left","30px")}}}}function w(c){if(y(c)){var d,e={x:B(c),y:C(c)},f=(new Date).getTime();if(J.css("top","0px"),J.css("left","0px"),z(R,f,Q,e)){var g=A(Q,e);"down"===g||"right"===g?2===H.currentPage?d=0:1<H.currentPage&&(d=H.getPrevious().midPoint):H.currentPage<H.length&&(d=H.getNext().midPoint),a(b).scrollTop(d)}}}function x(a,b){var c;return function(){clearTimeout(c),c=setTimeout(function(){a.apply(null,arguments)},b)}}function y(a){return a.originalEvent.hasOwnProperty("pointerType")&&"mouse"===a.originalEvent.pointerType?!1:!0}function z(a,b,c,d){var e=700,f=75,g=b-a,h=d.x-c.x,i=d.y-c.y,j=Math.sqrt(h*h+i*i);return g>e||f>j?!1:!0}function A(a,b){var c,d=b.x-a.x,e=b.y-a.y,f=Math.atan2(e,d);return c=-Math.PI/4<f&&f<=Math.PI/4?"right":-3/4*Math.PI<f&&f<=-Math.PI/4?"up":.75*Math.PI<f||f<-3/4*Math.PI?"left":"down"}function B(a){var b;return b=a.originalEvent.hasOwnProperty("changedTouches")?a.originalEvent.changedTouches[0].clientX:a.originalEvent.clientX}function C(a){var b;return b=a.originalEvent.hasOwnProperty("changedTouches")?a.originalEvent.changedTouches[0].clientY:a.originalEvent.clientY}function D(a,b){this.domNode=a,this.index=b,this.isClone=!1,this.layout=this.getLayout(),this.isTall=!1,this.pageOverhang=0,this.originalComputedStyle=this.cloneComputedStyle(),this.staggerOrder=0}function E(a){"undefined"!=typeof a&&this.fromSelector(a)}function F(a){this.top=0,this.bottom=0,this.height=0,this.nodes=new E,this.pageNumber=a||0,this.domNode=null,this.hideTimer=null,Object.defineProperty(this,"pageId",{get:function(){return"hrz-page-"+this.pageNumber}}),Object.defineProperty(this,"midPoint",{get:function(){return(this.bottom+this.top)/2/I.scrollbarShortenRatio}})}function G(){var a=1;Object.defineProperty(this,"currentPage",{get:function(){return a},set:function(b){a=this.last()<b?this.last():1>b?1:b}})}var H,I,J,K,L,M,N,O=function(){function b(a){var b,e=1,f=new G;for(b=0;b<a.length;b++){var g=a[b],h=f.getLastOffset()+M,i=c(g,h);if(i&&!g.isClone){g.isTall=!0;for(var j=g.layout.bottom-h,k=1;j>0;){var l=b+k,m=g.makeClone(l);m.pageOverhang=j,a.splice(l,0,m),j-=M,k++}}e=d(g,f,e);var n,o=f.last().bottom===g.layout.bottom;n=o||g.isClone||g.newPage?e:f.getPageAtOffset(g.layout.top).pageNumber,f.getPage(n).addNode(g)}return f}function c(b,c){var d=!1;return a(b.domNode).hasClass(I.newPageClass)?M<b.layout.height&&(d=!0):M/2<b.layout.height&&c<b.layout.bottom&&(d=!0),d}function d(b,c,d){if(a(b.domNode).hasClass(I.newPageClass)&&(d++,b.newPage=!0),void 0!==c[d-1]){var e=c.getPage(d),f=e.top+M;if(e.bottom<=b.layout.bottom){var g=f<b.layout.bottom;if(b.isTall)g&&(e.bottom=f);else if(g||b.isClone){d++,c.add();var h=c.last();M<b.layout.height?(h.bottom=f,b.pageOverhang&&(h.bottom+=Math.min(b.pageOverhang,M))):h.bottom=b.layout.bottom}else e.bottom=b.layout.bottom}}else c.add(),c.last().bottom=b.layout.bottom;return d}var e={};return e.fromNodeCollection=b,e}();b.horizonal=new d;var P,Q,R,S=function(){function a(c){d.forEach(function(a){a.call(a,c)}),0<d.length&&b.requestAnimationFrame(a)}var c={},d=[];return c.start=function(c){d.push(c),1===d.length&&b.requestAnimationFrame(a)},c.stop=function(a){d.splice(d.indexOf(a),1)},c}();D.prototype={cloneComputedStyle:function(){for(var a=c.createElement("div").style,d=b.getComputedStyle(this.domNode),e=0;e<d.length;e++){var f=d[e];a.setProperty(f,d.getPropertyValue(f),d.getPropertyPriority(f))}return a},getLayout:function(){var b=a(this.domNode),c=b.offset().left-K.offset().left,d=b.offset().top-K.offset().top-parseInt(b.css("margin-top")),e=b.width()+parseInt(b.css("padding-left"))+parseInt(b.css("padding-right")),f=b.height()+parseInt(b.css("padding-top"))+parseInt(b.css("padding-bottom")),g=d+f;return{top:d,left:c,bottom:g,width:e,height:f}},makeClone:function(b){var c=a(this.domNode).clone()[0],d=new D(c,b);return d.layout={top:this.layout.top,left:this.layout.left,width:this.layout.width,height:this.layout.height,bottom:this.layout.bottom},d.isClone=!0,d},appendToDom:function(b){a(this.domNode).addClass(b.pageId),J.find("#"+b.pageId).append(this.domNode)},renderStyles:function(b){this.applyStyleDiff(),a(this.domNode).addClass("hrz-element"),this.setCssPosition(b),this.setTransitionDelay(),this.setRestorePoint()},applyStyleDiff:function(){var b=this.getStyleDiff();a(this.domNode).css(b)},setCssPosition:function(b){var c=1===b.pageNumber?0:I.pageMargin;a(this.domNode).css({position:"absolute",top:this.layout.top-b.top+c+"px",left:this.layout.left+"px",width:this.layout.width+"px",height:this.layout.height+"px"})},setTransitionDelay:function(){function b(a){return"undefined"!=typeof a&&"0s"!==a}var c=this.getStaggerDelay();if(c>0){var d=a(this.domNode).css.bind(a(this.domNode)),e=b(d("transition-duration"))||b(d("-webkit-transition-duration")),f=b(d("animation-duration"))||b(d("-webkit-animation-duration"));e&&d({"transition-delay":c+"s","-webkit-transition-delay":c+"s"}),f&&d({"animation-delay":c+"s","-webkit-animation-delay":c+"s"})}},getStaggerDelay:function(){var a=I.staggerDelay*this.staggerOrder;return Math.round(100*a)/100},getStyleDiff:function(){for(var a={},c=b.getComputedStyle(this.domNode),d=0;d<c.length;d++){var e=c[d],f=this.originalComputedStyle.getPropertyValue(e);if(c.getPropertyValue(e)!=f){if("-ms"==e.substring(0,3))continue;null!==f&&(a[c[d]]=f)}}return a},moveTo:function(a){var b=this;setTimeout(function(){I.onNodeTransition(a,b.getPublicObject(),S)},1e3*this.getStaggerDelay())},setRestorePoint:function(){this.inlineStyle=this.domNode.cloneNode().style},restore:function(){var a,b;for(b=this.domNode.style.length;b>=0;b--)a=this.domNode.style[b],this.domNode.style.removeProperty(a);for(b=this.inlineStyle.length;b>=0;b--)a=this.inlineStyle[b],this.domNode.style.setProperty(a,this.inlineStyle.getPropertyValue(a),priority=this.inlineStyle.getPropertyPriority(a))},getPublicObject:function(){return{domNode:this.domNode,index:this.index,staggerOrder:this.staggerOrder,restore:this.restore.bind(this)}}};var T={fromSelector:function(b){var c=this,d=K.find(b).filter(":visible").not(".hrz-loading-indicator"),e=a([]);d.each(function(c,d){0===a(d).parents(b).length&&(e=e.add(d))}),e.each(function(a,b){var d=new D(b,a);c.push(d)})},appendToDom:function(a){for(var b=[],c=1;c<=this.length;c++)b.push(c);"random"===I.stagger&&(b=m(b)),this.forEach(function(c,d){c.staggerOrder=b[d],c.appendToDom(a)})}};E.prototype=[],a.extend(E.prototype,T),F.prototype={addNode:function(a){this.nodes.push(a)},appendToDom:function(a){var b="";b=this.pageNumber<a?"hrz-back hrz-hidden":a<this.pageNumber?"hrz-fore hrz-hidden":"hrz-focus-from-fore",J.append('<div class="hrz-page '+b+'" id="'+this.pageId+'" />'),this.domNode=J.find("#"+this.pageId)[0],this.nodes.appendToDom(this)},moveToForeground:function(){I.onPageTransition("toForeground",this.getPublicObject(),S),a(this.domNode).addClass("hrz-fore").removeClass("hrz-back hrz-focus-from-back hrz-focus-from-fore"),this.hideAfterDelay(),this.nodes.forEach(function(a){a.moveTo("toForeground")})},moveToBackground:function(){I.onPageTransition("toBackground",this.getPublicObject(),S),a(this.domNode).addClass("hrz-back").removeClass("hrz-fore hrz-focus-from-back hrz-focus-from-fore"),this.hideAfterDelay(),this.nodes.forEach(function(a){a.moveTo("toBackground")})},moveToFocusFromBackground:function(){I.onPageTransition("toFocusFromBack",this.getPublicObject(),S),a(this.domNode).addClass("hrz-focus-from-back"),this._moveToFocus("toFocusFromBack")},moveToFocusFromForeground:function(){I.onPageTransition("toFocusFromFore",this.getPublicObject(),S),a(this.domNode).addClass("hrz-focus-from-fore"),this._moveToFocus("toFocusFromFore")},_moveToFocus:function(b){a(this.domNode).removeClass("hrz-fore hrz-back hrz-hidden"),null!==this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null),this.nodes.forEach(function(a){a.moveTo(b)})},hideAfterDelay:function(){var b=a(this.domNode);this.hideTimer=setTimeout(function(){b.addClass("hrz-hidden")},1e3*I.pageHideDelay)},getPublicObject:function(){return{domNode:this.domNode,pageNumber:this.pageNumber}}};var U={getPage:function(a){return a>0&&a<=this.length?this[a-1]:new F},getCurrent:function(){return this.getPage(this.currentPage)},getNext:function(){return this.getPage(this.currentPage+1)},getPrevious:function(){return this.getPage(this.currentPage-1)},add:function(){var a=this.length+1,b=new F(a);b.top=this.getPage(this.length).bottom,this.push(b)},last:function(){return this[this.length-1]},getLastOffset:function(){return this.length<=1?0:this.last().top},getPageAtOffset:function(a){return this.filter(function(b){return b.top<=a&&a<b.bottom})[0]||this[0]},appendToDom:function(a){var b=this;a=a||0,this.currentPage=this.getPageAtOffset(a*I.scrollbarShortenRatio).pageNumber,this.forEach(function(a){a.appendToDom(b.currentPage)})},showPage:function(a){var b=this.currentPage;this.currentPage=a;var c=this.currentPage;if(0===b)this.getPage(c)._moveToFocus();else{var d;if(c>b){for(d=b;c>d;d++)this.getPage(d).moveToBackground();this.getPage(c).moveToFocusFromForeground()}else if(b>c){for(d=b;d>c;d--)this.getPage(d).moveToForeground();this.getPage(c).moveToFocusFromBackground()}}}};G.prototype=[],a.extend(G.prototype,U)}(jQuery,window,document);