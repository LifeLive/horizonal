/*! horizonal 26-07-2014 */
!function(a,b,c){function d(){function c(c){var d=a(b).scrollTop();t=a.extend({},z,c),u().then(function(){x?(j(),q()):(v=a(t.rootElement),w=v.clone(),q(),e(d),g(),x=!0),""!==b.location.hash&&n()})}function d(){y||(v.replaceWith(w.clone()),r(),y=!0)}function f(){y&&(j(),q(),""!==b.location.hash&&n(),y=!1)}function h(a){var b;"#"===a.substr(0,1)?n(a):(b=a,s.showPage(b))}function o(){var c=s.currentPage,d=s.length;if(d>c){var e=s.getPage(c+1).midPoint;a(b).scrollTop(e)}}function p(){var c=s.currentPage;if(c>1){var d=s.getPage(c-1).midPoint;a(b).scrollTop(d)}}function q(){a(b).on("resize",k(j,250)),a(b).on("keydown",l),a(b).on("scroll",m),a(b).on("hashchange",n)}function r(){a(b).off("resize",k(j,250)),a(b).off("keydown",l),a(b).off("scroll",m),a(b).off("hashchange",n)}function u(){function b(b){c=a("#hrz-custom-css"),0<c.length?c.text(b):a("head").append('<style id="hrz-custom-css" type="text/css">'+b+"</style>"),d.resolve()}var c,d=new a.Deferred;return t.customCssFile?a.get(t.customCssFile).then(b):(a("#hrz-custom-css").remove(),d.resolve()),d.promise()}var x=!1,y=!1,z={selector:"h1, h2, h3, h4, h5, h6, p, li, img, table",stagger:"random",staggerDelay:.1,customCssFile:!1,displayScrollbar:!0,scrollbarShortenRatio:2,pageMargin:20,displayPageCount:!0,rootElement:"body",newPageClass:"hrz-start-new-page",pageHideDelay:1,onResize:i,onNodeTransition:i,onPageTransition:i};return{init:c,enable:f,disable:d,goTo:h,next:o,previous:p}}function e(c){v=a(t.rootElement),v.wrapInner('<div id="hrz-container"></div>'),u=a("#hrz-container"),u.width(v.width()),x=a(b).height()-2*t.pageMargin;var d=new p(t.selector);s=d.splitIntoPages(),s.renderToDom(c),u.children().not(".hrz-page").filter(":visible").remove();var e=s.last().bottom/t.scrollbarShortenRatio+x;v.height(e),t.displayScrollbar||v.css("overflow-y","hidden"),f()}function f(){if(0===a(".hrz-page-count").length){var b=a('<div class="hrz-page-count"></div>');a("body").append(b),b.append('<span id="hrz-current-page"></span> / <span id="hrz-total-pages"></span>'),a("#hrz-total-pages").html(s.length),t.displayPageCount||b.addClass("hidden")}}function g(){a("#hrz-current-page").html(s.currentPage)}function h(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}function i(){}function j(){var c=s.getCurrent().nodes[0].layout.top/t.scrollbarShortenRatio;v.replaceWith(w.clone()),e(c),a(b).scrollTop(c),g(),t.onResize()}function k(a,b){var c;return function(){clearTimeout(c),c=setTimeout(function(){a()},b)}}function l(c){var d;40===c.which||39===c.which?s.currentPage<s.length&&(d=s.getNext().midPoint):(38===c.which||37===c.which)&&(2===s.currentPage?d=0:1<s.currentPage&&(d=s.getPrevious().midPoint)),void 0!==d&&a(b).scrollTop(d)}function m(){var c=a(b).scrollTop(),d=s.currentPage,e=s.getPageAtOffset(c*t.scrollbarShortenRatio).pageNumber;e!==d&&(s.showPage(e),g())}function n(){var c=b.location.hash;if(""!==c){var d=a(c).closest(".hrz-page"),e=parseInt(d.attr("id").replace(/^\D+/g,""));s.showPage(e),a(b).scrollTop(s.getCurrent().midPoint),g()}}function o(a,b){this.domNode=a,this.index=b,this.isClone=!1,this.layout=this.getLayout(),this.isTall=!1,this.pageOverhang=0,this.originalComputedStyle=this.cloneComputedStyle(),this.staggerOrder=0}function p(a){"undefined"!=typeof a&&this.fromSelector(a)}function q(a){this.top=0,this.bottom=0,this.height=0,this.nodes=new p,this.pageNumber=a||0,this.domNode=null,this.hideTimer=null,Object.defineProperty(this,"pageId",{get:function(){return"hrz-page-"+this.pageNumber}}),Object.defineProperty(this,"midPoint",{get:function(){return(this.bottom+this.top)/2/t.scrollbarShortenRatio}})}function r(){var a=1;Object.defineProperty(this,"currentPage",{get:function(){return a},set:function(b){a=this.last()<b?this.last():1>b?1:b}})}var s,t,u,v,w,x;b.horizonal=new d,o.prototype={cloneComputedStyle:function(){for(var a=c.createElement("div").style,d=b.getComputedStyle(this.domNode),e=0;e<d.length;e++){var f=d[e];a.setProperty(f,d.getPropertyValue(f),d.getPropertyPriority(f))}return a},getLayout:function(){var b=a(this.domNode),c=b.offset().left-v.offset().left,d=b.offset().top-v.offset().top-parseInt(b.css("margin-top")),e=b.width()+parseInt(b.css("padding-left"))+parseInt(b.css("padding-right")),f=b.height()+parseInt(b.css("padding-top"))+parseInt(b.css("padding-bottom")),g=d+f;return{top:d,left:c,bottom:g,width:e,height:f}},makeClone:function(b){var c=a(this.domNode).clone()[0],d=new o(c,b);return d.layout={top:this.layout.top,left:this.layout.left,width:this.layout.width,height:this.layout.height,bottom:this.layout.bottom},d.isClone=!0,d},renderToDom:function(b){a(this.domNode).addClass(b.pageId),a("#"+b.pageId).append(this.domNode),this.applyStyleDiff(),a(this.domNode).addClass("hrz-element"),this.setCssPosition(b),this.setTransitionDelay(),this.setRestorePoint()},applyStyleDiff:function(){var b=this.getStyleDiff();a(this.domNode).css(b)},setCssPosition:function(b){var c=1===b.pageNumber?0:t.pageMargin;a(this.domNode).css({position:"fixed",top:this.layout.top-b.top+c+"px",left:this.layout.left+"px",width:this.layout.width+"px",height:this.layout.height+"px"})},setTransitionDelay:function(){function b(a){return"undefined"!=typeof a&&"0s"!==a}var c=this.getStaggerDelay();if(c>0){var d=a(this.domNode).css.bind(a(this.domNode)),e=b(d("transition-duration"))||b(d("-webkit-transition-duration")),f=b(d("animation-duration"))||b(d("-webkit-animation-duration"));e&&(a(this.domNode).css({"transition-delay":c+"s","-webkit-transition-delay":c+"s"}),this.domNode.style.transitionDelay=c+"s",this.domNode.style.webkitTransitionDelay=c+"s"),f&&a(this.domNode).css({"animation-delay":c+"s","-webkit-animation-delay":c+"s"})}},getStyleDiff:function(){for(var a={},c=b.getComputedStyle(this.domNode),d=0;d<c.length;d++){var e=c[d];c.getPropertyValue(e)!=this.originalComputedStyle.getPropertyValue(e)&&(a[c[d]]=this.originalComputedStyle.getPropertyValue(e))}return a},getStaggerDelay:function(){var a=t.staggerDelay*this.staggerOrder;return Math.round(100*a)/100},moveToForeground:function(){var a=this;setTimeout(function(){t.onNodeTransition("toForeground",a.getPublicObject())},1e3*this.getStaggerDelay())},moveToBackground:function(){var a=this;setTimeout(function(){t.onNodeTransition("toBackground",a.getPublicObject())},1e3*this.getStaggerDelay())},moveToFocus:function(){var a=this;setTimeout(function(){t.onNodeTransition("toFocus",a.getPublicObject())},1e3*this.getStaggerDelay())},setRestorePoint:function(){this.inlineStyle=this.domNode.cloneNode().style},restore:function(){var a,b;for(b=this.domNode.style.length;b>0;b--)a=this.domNode.style[b],this.domNode.style.removeProperty(a);for(b=this.inlineStyle.length;b>0;b--)a=this.inlineStyle[b],this.domNode.style.setProperty(a,this.inlineStyle.getPropertyValue(a),priority=this.inlineStyle.getPropertyPriority(a))},getPublicObject:function(){return{domNode:this.domNode,index:this.index,staggerOrder:this.staggerOrder,restore:this.restore.bind(this)}}};var y={fromSelector:function(b){var c=this,d=a(b).filter(":visible"),e=a([]);d.each(function(c,d){0===a(d).parents(b).length&&(e=e.add(d))}),e.each(function(a,b){var d=new o(b,a);c.push(d)})},splitIntoPages:function(){var a,b=1,c=new r;for(a=0;a<this.length;a++){var d=this[a],e=c.getLastOffset()+x,f=this.isNodeTall(d,e);if(f&&!d.isClone){d.isTall=!0;for(var g=d.layout.bottom-e,h=1;g>0;){var i=a+h,j=d.makeClone(i);j.pageOverhang=g,this.splice(i,0,j),g-=x,h++}}b=this.calculateLastPageAndPageOffset(d,c,b),c.getPage(b).addNode(d)}return c},isNodeTall:function(b,c){var d=!1;return a(b.domNode).hasClass(t.newPageClass)?x<b.layout.height&&(d=!0):x/2<b.layout.height&&c<b.layout.bottom&&(d=!0),d},calculateLastPageAndPageOffset:function(b,c,d){if(a(b.domNode).hasClass(t.newPageClass)&&d++,void 0!==c[d-1]){var e=c.getPage(d),f=e.top+x;if(e.bottom<=b.layout.bottom){var g=f<b.layout.bottom;if(b.isTall)g&&(e.bottom=f);else if(g||b.isClone){d++,c.add();var h=c.last();x<b.layout.height?(h.bottom=f,b.pageOverhang&&(h.bottom+=Math.min(b.pageOverhang,x))):h.bottom=b.layout.bottom}else e.bottom=b.layout.bottom}}else c.add(),c.last().bottom=b.layout.bottom;return d},renderToDom:function(a){for(var b=[],c=1;c<=this.length;c++)b.push(c);"random"===t.stagger&&(b=h(b)),this.forEach(function(c,d){c.staggerOrder=b[d],c.renderToDom(a)})}};p.prototype=[],a.extend(p.prototype,y),q.prototype={addNode:function(a){this.nodes.push(a)},renderToDom:function(b){var c="";c=this.pageNumber<b?"hrz-back hrz-hidden":b<this.pageNumber?"hrz-fore hrz-hidden":"hrz-focus-from-fore",u.append('<div class="hrz-page '+c+'" id="'+this.pageId+'" />'),this.domNode=a("#"+this.pageId)[0],this.nodes.renderToDom(this)},moveToForeground:function(){a(this.domNode).removeClass("hrz-back hrz-focus-from-back hrz-focus-from-fore").addClass("hrz-fore"),this.hideAfterDelay(),this.nodes.forEach(function(a){a.moveToForeground()})},moveToBackground:function(){a(this.domNode).removeClass("hrz-fore hrz-focus-from-back hrz-focus-from-fore").addClass("hrz-back"),this.hideAfterDelay(),this.nodes.forEach(function(a){a.moveToBackground()})},moveToFocusFromBackground:function(){a(this.domNode).addClass("hrz-focus-from-back"),this.moveToFocus()},moveToFocusFromForeground:function(){a(this.domNode).addClass("hrz-focus-from-fore"),this.moveToFocus()},moveToFocus:function(){a(this.domNode).removeClass("hrz-fore hrz-back hrz-hidden"),null!==this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null),this.nodes.forEach(function(a){a.moveToFocus()})},hideAfterDelay:function(){var b=a(this.domNode);this.hideTimer=setTimeout(function(){b.addClass("hrz-hidden")},1e3*t.pageHideDelay)}};var z={getPage:function(a){return a>0&&a<=this.length?this[a-1]:new q},getCurrent:function(){return this.getPage(this.currentPage)},getNext:function(){return this.getPage(this.currentPage+1)},getPrevious:function(){return this.getPage(this.currentPage-1)},add:function(){var a=this.length+1,b=new q(a);b.top=this.getPage(this.length).bottom,this.push(b)},last:function(){return this[this.length-1]},getLastOffset:function(){return this.length<=1?0:this.last().top},getPageAtOffset:function(a){return this.filter(function(b){return b.top<=a&&a<b.bottom})[0]||this[0]},renderToDom:function(a){var b=this;a=a||0,this.currentPage=this.getPageAtOffset(a*t.scrollbarShortenRatio).pageNumber,this.forEach(function(a){a.renderToDom(b.currentPage)})},showPage:function(a){var b=this.currentPage;this.currentPage=a;var c=this.currentPage;if(0===b)this.getPage(c).moveToFocus();else{var d;if(c>b){for(d=b;c>d;d++)this.getPage(d).moveToBackground();this.getPage(c).moveToFocusFromForeground()}else if(b>c){for(d=b;d>c;d--)this.getPage(d).moveToForeground();this.getPage(c).moveToFocusFromBackground()}}}};r.prototype=[],a.extend(r.prototype,z)}(jQuery,window,document);